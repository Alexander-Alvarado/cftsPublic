{% load static %} <!-- Has to load first to use static helper -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <link rel="stylesheet" href="{% static 'css/styleAdmin.css' %}">    
    <link rel="stylesheet" href="{% static 'css/ddGlobal.css' %}"> <!-- DD CSS -->
    <title>CFTS</title>
</head>
<body>

    <!-- Navbar -->
    {% include 'partials/_navbarAdmin.html' %}

    <!--  To make the tabs toggleable, add the data-toggle="tab" attribute to each link. Then add a .tab-pane class with a unique ID for every tab and wrap them inside a div element with class .tab-content.  -->
    <div class="container" style="margin-top: 200px;">
        <div class="card">
            <div class="card-header">

                <ul class="nav nav-tabs mt-5">
                {% for network in rc.queues %}
                    <li class="nav-item{% if network.count == 0 %} disabled{% endif %}">
                        <a class="nav-link{% if forloop.counter0 == 0 %} active{% endif %}"
                        {% if network.count != 0 %} 
                            data-toggle="tab" 
                            href="#tab{{ network.name }}"
                        {% endif %}>
                            {{ network.name }}
                        </a>
                    </li>
                {% endfor %}
                </ul>

                <div class="tab-content">
                {% for network in rc.queues %}
                    <div id="tab{{ network.name }}" class="tab-pane container{% if forloop.counter0 == 0 %} active{% else %} fade{% endif %}">
                    {% if network.count == 0 %}
                        {{ rc.empty }}
                    {% else %}
                        <div class="network-header">
                            {% for lp in network.last_pull %}
                            <div class="pending-info">
                                Pending Requests: {{ network.pending.count }} ({{network.file_count.files_in_dataset}} Files)
                                <br />
                                <span class="last-pull-info">( Last pull created: 
                                    <span class="date-pulled">{{ lp.date_pulled|date:'db'|upper }} {{ lp.date_pulled|time:'Hi' }}</span> 
                                    by <span class="user-pulled">{{ lp.user_pulled__username }}</span> )
                                </span>
                            </div>
                            <div class="create-pull">
                                <button class="btn btn-primary pull-button{% if network.pending.count == 0 %} disabled{% endif %}" id="pull{{network.name}}">Create {{ network.name }} Pull</button>                                 
                            </div>
                            <div class="download-block">
                                <a class="btn btn-primary download-button" id="dl{{network.name}}" href="/static/files/{{ network.name }}_{{ lp.pull_number }}.zip">Downoad Current {{ network.name }} Zip</a>
                            </div>
                            {% endfor %}
                        </div>

                        <form class="queue-form">
                        <table width="100%" border="0" cellpadding="5" cellspacing="5">
                            <colgroup>
                                <col width="10%" />
                                <col />
                                <col width="30%" />
                            </colgroup>
                            {% for request in network.q %}
                            <tr class="{% if request.date_pulled %}pending{% endif %}">
                                <td colspan="2"><a href="{% url 'transfer-request' id=request.request_id %}">{{ request.user }}</a></td> <!-- link to request view -->
                                <td>{{ request.date_created|date:'db'|upper }} {{ request.date_created|time:'H:i:s e' }}</td>
                            </tr>
                            {% for file in request.files.all %}
                            <tr class="{% if request.date_pulled %}pending{% endif %}">
                                <td><input type="checkbox" name="fileSelection" id="reqeust_{{ request.request_id }}" /></td>
                                <td colspan="2">{{ file }}</td>
                            </tr>
                            <!-- end files -->
                            {% endfor %}
                            <!-- end requests -->
                            {% endfor %}
                        </table>
                        </form>

                        <!-- delete selected button -->
                        <button class="btn btn-danger">Delete Selected</button>

                    {% endif %}
                    </div>
                {% endfor %}
                </div>

            </div> <!-- END card-header -->
        </div><!-- END card -->
    </div> <!-- END container -->

    {% include 'partials/_footerAdmin.html' %}

    <script src="{% static 'js/jquery-3.4.1.min.js' %}"></script>
    <script src="{% static 'js/bootstrap.js' %}"></script>
    <script src="{% static 'js/analysts.js' %}"></script>

</body>

</html>