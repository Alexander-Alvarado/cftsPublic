{% extends 'base.html' %}
{% load static %}
{% load util %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/scan.css' %}">

<section class="p-3" id="scan-results">
  <h3>Pull contains the following scan results:</h3>
  <table id="rootList" class="list-group">
    {% for request in requests %}
      <tbody class="p-2 mb-1">
        <tr>
          <td class="p-1 mb-1">Request: <a href="{% url 'admin:pages_request_change' request.request_id %}">{{request.user}} {{ request.date_created|date:'db'|upper }} @ {{ request.date_created|time:'Hi' }}</a></td>
        </tr>
        {% for file in request.files.all %}
          {% if file.rejection_reason == None%}
            {% include 'partials/Scan_partials/scanResults.html' with results=file.scan_results file_id=file.file_id pull=True %}
          {% endif %}
        {% endfor %}
      </tbody>
    {% endfor %}
  </table>
</section>

<!-- Add client side javascript checks to verify the file being uploaded is what it says it is -->
<!-- I mean, we should be able to trust our own analysts... but they're also users. And I don't -->
<!-- trust users any further than I can shot put them. -->
<script>window.document.title = "Scan Tool";</script>
{% endblock %}